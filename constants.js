const THEMES = {
    matrix: { primary: '#00ff00', background: '#000000', accent: '#003300' },
    cyberpunk: { primary: '#ff00ff', background: '#000033', accent: '#00ffff' },
    sunset: { primary: '#ff8800', background: '#1a0033', accent: '#ff3300' },
    neon: { primary: '#0ff', background: '#001', accent: '#06f' }
};

const MATRIX_CONFIG = {
    MAX_TRAIL_LENGTH: 30,
    MAX_CONCURRENT_DROPS: 5,
    HEAD_CHARS: ['@', '#', '£', '€', '¥', '§', '¶', 'ŧ'],
    TRAIL_CHARS: ['*', '+', '·', '~', ':', '"', '°', '·'],
    GLOW_CHARS: ['Æ', 'Ø', 'Œ', 'ª', 'º', '₿', '¢', '¿'],
    BASE_SPEED: 0.04,
    DROP_VARIANCE: 0.6,
    MAX_SPEED: 0.7,
    SPARKLE_RATE: 0.005
};

const MODES = [
    'Wave', 'Spiral', 'Vortex',
    'Mandala', 'Tunnel', 'Fractal', 'Interference', 
    'Psychedelic', 'Cellular', 'Shockwave', 'Plasma', 'Ripple',
    'Matrix', 'Camera'
];

const CHAR_SETS = [
    { name: 'Basic', chars: ['@', '#', '$', '%', '&', '*', '+', '=', '-', ':', '.', '·'] },
    { name: 'Blocks', chars: ['█', '▓', '▒', '░', '▄', '▀', '■', '□', '◼', '◻'] },
    { name: 'Lines', chars: ['║', '═', '╬', '╩', '╦', '╣', '╠', '╗', '╝', '╚', '╔'] },
    { name: 'Math', chars: ['π', '∞', 'Σ', '∫', 'Δ', '√', '≈', '≠', '≤', '≥', '±'] },
    { name: 'Shapes', chars: ['◆', '◈', '○', '◎', '●', '◕', '◔', '★', '☆', '✦'] },
    { name: 'Binary', chars: ['0', '1'] },
    { 
        name: 'Arrows', 
        chars: ['←','↑','→','↓','↔','↕','↖','↗','↘','↙','↺','↻']
    },
    {
        name: 'Greek',
        chars: ['α','β','γ','δ','ε','ζ','η','θ','ι','κ','λ','μ','ν','ξ','ο','π','ρ','σ','τ','υ','φ','χ','ψ','ω']
    },
    {
        name: 'Dots',
        chars: ['⣀','⣄','⣤','⣦','⣶','⣷','⣿','⡿','⢟','⣻','⣽','⣾','⠁','⠂','⠄','⡀','⢀','⠠','⠐','⠈']
    },
    {
        name: 'Braille',
        chars: ['⣿','⢿','⣻','⣽','⣾','⣷','⣯','⣟','⡿','⠿','⢻','⣹','⣤','⣄','⣠','⡀','⠄','⠂','⠁','⠀']
    },
    {
        name: 'Technical',
        chars: ['⌘','⌥','⌫','⌦','⎋','⇧','⌃','⏎','⏏','⏻','⏼','⭾','⌅','⌤','⌷','⌨','⍆','⍅','⍇','⍈']
    },
    {
        name: 'Currency',
        chars: ['$','€','£','¥','¢','₽','₩','₺','₴','₹','₿','₸','₮','₦','₡','₫','₭','₱','₲','₵','₳','₠']
    },
    {
        name: 'Emoji',
        chars: ['☀','☁','☂','☃','☄','★','☆','☇','☈','☉','☊','☋','☌','☍','☎','☏','☐','☑','☒','☕','☖','☗']
    },
    {
        name: 'Chess',
        chars: ['♔','♕','♖','♗','♘','♙','♚','♛','♜','♝','♞','♟']
    },
    {
        name: 'Weather',
        chars: ['☀️','☁️','⛅️','🌧️','⛈️','🌩️','❄️','💧','🌪️','🌈','☔️']
    },
    {
        name: 'Music',
        chars: ['♩','♪','♫','♬','♭','♯','🎵','🎶','🎷','🎺','🎸','🥁']
    },
    {
        name: 'Stars',
        chars: ['★','☆','✦','✧','✩','✪','✫','✬','✭','✮','✯']
    },
    {
        name: 'Animals',
        chars: ['🐅','🐆','🦓','🦍','🐘','🦛','🐊','🐢','🐍','🦎','🐓']
    },
    {
        name: 'Plants',
        chars: ['🌵','🎄','🌲','🌳','🌴','🌱','🌿','☘️','🍀','🎍']
    },
    {
        name: 'Tools',
        chars: ['⚒️','🛠️','🔧','🔨','⚔️','💣','🔫','🏹','🪓','🔗']
    },
    {
        name: 'Shapes2',
        chars: ['◖','◗','◑','◐','◓','◒','◆','◇','◈','◉','◎','◌','◍']
    },
    {
        name: 'MonoShapes',
        chars: ['◼','◻','◢','◣','◤','◥','◧','◨','◩','◪','◫']
    },
    {
        name: 'Fractions',
        chars: ['½','⅓','⅔','¼','¾','⅕','⅖','⅗','⅘','⅙','⅚','⅛','⅜','⅝','⅞']
    },
    {
        name: 'Math2',
        chars: ['∩','∪','∈','∉','∅','∏','∑','√','∛','∜','∞','∡','∢','∥','∦']
    },
    {
        name: 'Boxes',
        chars: [' ','▂','▃','▄','▅','▆','▇','█','▉','▊','▋','▌','▍','▎','▏']
    },
    {
        name: 'Circles',
        chars: ['○','◌','●','◎','◉','◍','◯','⦿','⦾','⦽','⦼','⦻','⦸','⦷','⦶']
    },
    {
        name: 'Stars2',
        chars: ['✶','✷','✸','✹','✺','✻','✼','✽','✾','✿','❀','❁','❂','❃','❇']
    },
    {
        name: 'Arrows2',
        chars: ['↞','↟','↠','↡','↢','↣','↤','↥','↦','↧','↨','↫','↬','↭','↮']
    },
    {
        name: 'Shapes3',
        chars: ['◰','◱','◲','◳','◴','◵','◶','◷','◸','◹','◺','◻','◼','◽','◾']
    },
    {
        name: 'Currency2',
        chars: ['₠','₡','₢','₣','₤','₥','₦','₧','₨','₩','₪','₫','€','₭','₮']
    },
    {
        name: 'Misc',
        chars: ['⌖','⌗','⌘','⌙','⌚','⌛','⌜','⌝','⌞','⌟','⌠','⌡','⌢','⌣','⌤']
    },
    {
        name: 'Braille2',
        chars: ['⣾','⣽','⣻','⢿','⡿','⣟','⣯','⣷','⣿','⣶','⣤','⣄','⣀','⢀','⡀','⠄','⠂','⠁']
    },
    {
        name: 'Dots2',
        chars: ['⡀','⡁','⡂','⡃','⡄','⡅','⡆','⡇','⡈','⡉','⡊','⡋','⡌','⡍','⡎','⡏']
    },
    {
        name: 'Dots3',
        chars: ['⠁','⠂','⠄','⡀','⢀','⠠','⠐','⠈','⠘','⠃','⠅','⠆','⠇','⡈','⡉','⡊','⡋','⡌']
    },
    {
        name: 'BlockDots',
        chars: ['░','▒','▓','▚','▞','▛','▜','▟','▙','▝','▗','▖','▘','▔','▕','▏','▎','▍']
    },
    {
        name: 'CircleDots',
        chars: ['◌','◍','◎','●','○','◯','⦿','⦾','⦽','⦼','⦻','⦸','⦷','⦶','⚇','⚈','⚉']
    }
];

// Update existing CHARS to maintain compatibility
const CHARS = CHAR_SETS[0].chars;

class Ripple {
    constructor(x, y, maxRadius) {
        this.x = x;
        this.y = y;
        this.radius = 0;
        this.maxRadius = maxRadius;
        this.speed = 0.5;
        this.strength = 1;
        this.life = 1;
    }

    update() {
        this.radius += this.speed;
        this.life = 1 - (this.radius / this.maxRadius);
        return this.life > 0;
    }
} 